id: dsq-747532772
date: 2012-09-03T08:26:05.0000000-07:00
name: Bilal
avatar: https://disqus.com/api/users/avatars/Bilal.jpg
message: <p>[HttpPost]<br>        public ActionResult ParsedRequisition(HttpPostedFileBase file, Web.Areas.ViewModel.AddRequisitionViewModel addReq)<br>        {<br>            <br>            if (file != null &amp;&amp; file.ContentLength &gt; 0)<br>            {<br>                System.IO.DirectoryInfo myDirectory = new System.IO.DirectoryInfo(Server.MapPath("~/files"));<br>                FileInfo[] fileList = myDirectory.GetFiles();<br>                int count = fileList.Length;<br>                if (count == 0)<br>                {<br>                    file.SaveAs(Server.MapPath("~/files/" + file.FileName));<br>                    Microsoft.Office.Interop.Word.Application word = new Microsoft.Office.Interop.Word.Application();<br>                    object miss = System.Reflection.Missing.Value;<br>                    object path = Server.MapPath("~/files/" + file.FileName);<br>                    object readOnly = true;<br>                    string body=string.Empty;<br>                    Microsoft.Office.Interop.Word.Document docs = word.Documents.Open(ref path, ref miss, ref readOnly, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss);<br>                    for (int i = 0; i &lt; docs.Paragraphs.Count; i++)<br>                    {<br>                         body+= docs.Paragraphs[i + 1].Range.Text.ToString();<br>                        body += "&lt;br /&gt;";<br>                    }</p>
