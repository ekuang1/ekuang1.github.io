id: dsq-747534615
date: 2011-03-19T01:53:54.0000000-07:00
name: Eduardo
avatar: https://disqus.com/api/users/avatars/Eduardo.jpg
message: <p>There is another thing. <br>Since PCs have a dot as a decimal point in the numeric pad, and calculators and other electronic devices use only the point as a decimal separator, a lot people in Argentina (and in other countries where the decimal separator is the comma) is used to sometimes type the point as a separator.<br>I have this function since long time to try to guess the user intentions (have worked great for me)<br>(old vb code, not optimized)<br><code><br>    &lt;Extension()&gt; _<br>    Public Function TryCDec(ByRef texto As String) As Decimal<br>        If String.IsNullOrEmpty(texto) Then<br>            Return 0<br>        Else<br>            Dim SepDecimal As String, SepMiles As String<br>            texto = Replace(Trim(texto), "$", "")<br>            texto = Replace(Trim(texto), " ", "")<br>            If CDbl("3,24") = 324 Then<br>                SepDecimal = "."<br>                SepMiles = ","<br>            Else<br>                SepDecimal = ","<br>                SepMiles = "."<br>            End If<br>            If InStr(texto, SepDecimal) &gt; 0 Then<br>                If InStr(texto, SepMiles) &gt; 0 Then<br>                    If InStr(texto, SepDecimal) &gt; InStr(texto, SepMiles) Then<br>                        texto = Replace(texto, SepMiles, "")<br>                    Else<br>                        texto = Replace(texto, SepDecimal, "")<br>                        texto = Replace(texto, SepMiles, SepDecimal)<br>                    End If<br>                End If<br>            Else<br>                texto = Replace(texto, SepMiles, SepDecimal)<br>            End If<br>            Return CDec(texto)<br>        End If<br>    End Function<br></code><br></p>
