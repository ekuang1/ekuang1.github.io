id: dsq-747525642
date: 2008-07-02T01:10:24.0000000-07:00
name: edddy
avatar: https://disqus.com/api/users/avatars/edddy.jpg
message: <p>Fast translate for case-sensitive haters (or VB lovers)<br><code><br>Imports System<br>Imports System.Diagnostics<br>Imports System.Web<br><br>Public Class TimingModule<br>    Implements IHttpModule<br>    Public Sub Dispose() Implements System.Web.IHttpModule.Dispose<br>    End Sub<br>    Public Sub Init(ByVal context As System.Web.HttpApplication) Implements System.Web.IHttpModule.Init<br>        AddHandler context.BeginRequest, AddressOf OnBeginRequest<br>        AddHandler context.EndRequest, AddressOf OnEndRequest<br>    End Sub<br>    Sub OnBeginRequest(ByVal sender As Object, ByVal e As System.EventArgs)<br>        If (HttpContext.Current.Request.IsLocal AndAlso HttpContext.Current.IsDebuggingEnabled) Then<br>            Dim stopwatch As New Stopwatch()<br>            HttpContext.Current.Items("Stopwatch") = stopwatch<br>            stopwatch.Start()<br>        End If<br>    End Sub<br><br>    Sub OnEndRequest(ByVal sender As Object, ByVal e As System.EventArgs)<br>        If (HttpContext.Current.Request.IsLocal AndAlso HttpContext.Current.IsDebuggingEnabled) Then<br>            Dim stopwatch As Stopwatch = HttpContext.Current.Items("Stopwatch")<br>            stopwatch.Stop()<br>            Dim ts As TimeSpan = stopwatch.Elapsed<br>            Dim elapsedTime As String = String.Format("{0}ms", ts.TotalMilliseconds)<br>            HttpContext.Current.Response.Write("<p>" + elapsedTime + "</p>")<br>        End If<br>    End Sub<br>End Class<br></code></p>
