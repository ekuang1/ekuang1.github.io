id: dsq-747532040
date: 2012-08-26T04:22:25.0000000-07:00
name: Reza Baiat
avatar: https://disqus.com/api/users/avatars/Reza Baiat.jpg
message: "<p>I had problem with arrays and sub-objects. so I wrote this method after your notes in <a href=\"https://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx\" rel=\"nofollow noopener\" title=\"https://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx\">haacked.com/.../model-binding-to-a-list.aspx</a><br><code><br>var obj = {<br>    id: 89,<br>    name: 'reza baiat',<br>    con: [<br>        8,<br>        'rahim',<br>        {<br>            a: 9,<br>            b: 6,<br>            points:{<br>                x: 4,<br>                y: [5,6,7,8]<br>            }<br>        },<br>        {<br>            a: 10,<br>            b: 11,<br>            points:{<br>                x: 12,<br>                y: [13,14,15,16]<br>            }<br>        }<br>    ]<br>};<br><br>function getPostData(obj, prefix) {<br>    var result = '', type = '', aType = '';<br>    for (var prop in obj) {<br>        type = typeOf(obj[prop]);<br>        if (type == 'string' || type == 'number' || type == 'boolean') {<br>            result += '&amp;' + (prefix || '') + prop + '=' + encodeURIComponent(obj[prop]);<br>        } else if (type == 'object') {<br>            result += '&amp;' + getPostData(obj[prop], (prefix || '') + prop + '.');<br>        } else if (type == 'array') {<br>            for (var i = 0; i &lt; obj[prop].length; i++) {<br>                aType = typeOf(obj[prop][i]);<br>                if (aType == 'number' || aType == 'string' || aType == 'boolean') {<br>                    result += '&amp;' + (prefix || '') + prop + '[' + i + ']=' + encodeURIComponent(obj[prop][i]);<br>                } else if (aType == 'object') {<br>                    result += '&amp;' + getPostData(obj[prop][i], (prefix || '') + prop + '[' + i + '].');<br>                } else if (aType == 'array') {<br>                }<br>            }<br>        }<br>    }<br>    if (result.length &gt; 0) {<br>        result = result.substring(1);<br>    }<br>    return result;<br>}<br>alert(getPostData(obj));<br>// result: <br>/*<br>id=89&amp;name=ali%20reza%20hasani&amp;con[0]=8&amp;con[1]=rahim&amp;con[2].a=9&amp;con[2].b=6&amp;con[2].points.x=4&amp;con[2].points.y[0]=5&amp;con[2].points.y[1]=6&amp;con[2].points.y[2]=7&amp;con[2].points.y[3]=8&amp;con[3].a=10&amp;con[3].b=11&amp;con[3].points.x=12&amp;con[3].points.y[0]=13&amp;con[3].points.y[1]=14&amp;con[3].points.y[2]=15&amp;con[3].points.y[3]=16<br>*/<br></code><br>post getPostData(obj) to server. It will be mapped as you want. It is not complete but may help you<br></p>"
