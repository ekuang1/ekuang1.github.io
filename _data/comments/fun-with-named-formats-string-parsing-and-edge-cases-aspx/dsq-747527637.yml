id: dsq-747527637
date: 2009-01-05T20:02:17.0000000-08:00
name: Andrew
avatar: https://disqus.com/api/users/avatars/Andrew.jpg
message: <p>What about something like this:<br><code><br>  internal static class ObjectFormatter {<br>    internal static string Format(this object o, string format) {<br>      if (string.IsNullOrEmpty(format)) throw new ArgumentNullException("format");<br>      const string propertyPattern = "{(?&lt;PropertyName&gt;[a-z,0-9,_]*)}";<br>      MatchCollection matches = Regex.Matches(format, propertyPattern, RegexOptions.Compiled | RegexOptions.CultureInvariant | RegexOptions.IgnoreCase);<br>      foreach (Match match in matches) {<br>        string propertyName = match.Groups["PropertyName"].Value;<br>        PropertyInfo propertyInfo = o.GetType().GetProperty(propertyName);<br>        if (propertyInfo != null) {<br>          object propertyObject = propertyInfo.GetValue(o, null);<br>          string propertyValue = null;<br>          if (propertyObject != null) {<br>            propertyValue = propertyObject.ToString();<br>          }<br>          format = format.Replace(match.Value, propertyValue);<br>        }<br>      }<br>      return format;<br>    }<br>  }<br></code></p>
