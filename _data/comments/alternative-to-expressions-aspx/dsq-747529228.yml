id: dsq-747529228
date: 2009-06-15T02:19:00.0000000-07:00
name: Jamie Cansdale
avatar: https://disqus.com/api/users/avatars/Jamie Cansdale.jpg
message: <p>Another solution would be to constrain the complexity of expressions that are allowed as parameters. Simple expressions can be evaluated quickly using a little reflection.<br>For example, the following expression evaluator would support constants and for loops (your example):<br>static object GetValue(Expression expression)<br>{<br>    ConstantExpression constant = expression as ConstantExpression;<br>    if (constant != null)<br>    {<br>        return constant.Value;<br>    }<br>    MemberExpression member = expression as MemberExpression;<br>    if (member != null)<br>    {<br>        FieldInfo field = member.Member as FieldInfo;<br>        ConstantExpression c = member.Expression as ConstantExpression;<br>        if (field != null &amp;&amp; c != null)<br>        {<br>            return field.GetValue(c.Value);<br>        }<br>    }<br>    throw new ArgumentException("ComplexExpressionsNotSupported", "expression");<br>}<br>With a little more work I suspect you could nail the common cases. It is really necessary to support all complex expressions as ActionLink parameters? I think not supporting them would be a reasonable compromise. :)</p>
