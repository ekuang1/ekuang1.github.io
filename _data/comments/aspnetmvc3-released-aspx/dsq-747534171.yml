id: dsq-747534171
date: 2011-01-13T00:12:33.0000000-08:00
name: Igorbek
avatar: https://disqus.com/api/users/avatars/Igorbek.jpg
message: "<p>Hello!<br>I found some unexpected behavior when generating URL for actions: UriHelper.Action (or others) implictly takes route values from current context.<br>For example:<br>Routes:<br>routes.MapRoute(\"User\", \"{userId}/{controller}/{action}/{id}\", <br>new { controller = \"Home\", action = \"Index\", id = UrlParameter.Optional }, new { userId = \"^[1-9]\\\\d*$\" });<br>routes.MapRoute(\"Default\", \"{controller}/{action}/{id}\", new { controller = \"Home\", action = \"Index\", id = UrlParameter.Optional});<br>Controller:<br>public class HomeController : Controller<br>{<br>public ActionResult Index() { return View(); }<br>public ActionResult Test(int userId) { return View(\"Index\"); }<br>}<br>View 'Index':<br>Expected: \"/\", Actual: \"@Url.Action(\"Index\", \"Home\")\"<br>Expected: \"/10/Home/Test\", Actual: \"@Url.Action(\"Test\", \"Home\", new { userId = 10 })\"<br>Result of '/':<br>Expected: \"/\", Actual: \"/\"<br>Expected: \"/10/Home/Test\", Actual: \"/10/Home/Test\"<br>All right!<br>Result of '/10/Home/Test':<br>Expected: \"/\", Actual: \"/10\"<br>Expected: \"/10/Home/Test\", Actual: \"/10/Home/Test\"<br>Why? The route value 'userId' set implictly from current route values into generated route link!<br>Can you help me?</p>"
