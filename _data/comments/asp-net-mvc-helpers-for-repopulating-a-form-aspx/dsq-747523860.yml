id: dsq-747523860
date: 2007-12-22T02:56:15.0000000-08:00
name: tgmdbm
avatar: https://disqus.com/api/users/avatars/tgmdbm.jpg
message: <p>I've expanded your method to account for non primitives, and arrays or lists of objects/primitives.<br>This code is obviously slower because of the calls to GetType(). If someone can suggest a better way of doing this I'm all ears. Let me know if you find this useful.<br>[Apologies, this probably won't fit on the screen.] <br>&lt;pre&gt;<code><br>    public static void PopulateFrom(this IDictionary&lt;string, object&gt; store, object o, string prefix)<br>    {<br>      Type t = o.GetType();<br>      if( string.IsNullOrEmpty( prefix ) )<br>        prefix = t.Name;<br>      if( t.IsPrimitive )<br>        store[prefix] = o;<br>      else<br>      {<br>        prefix = prefix + ".";<br>        foreach( PropertyValue property in o.GetProperties() )<br>        {<br>          if( property.Value.GetType().IsPrimitive )<br>            store[prefix + property.Name] = property.Value;<br>          else if( property.Value is IEnumerable )<br>          {<br>            int index = 0;<br>            foreach( object subObject in property.Value as IEnumerable )<br>            {<br>              PopulateFrom( store, subObject, string.Format( "{0}{1}[{2}]", prefix, property.Name, index++ ) );<br>            }<br>          }<br>          else<br>            PopulateFrom( store, property.Value, string.Format( "{0}{1}", prefix, property.Name ) );<br>        }<br>      }<br>    }<br></code>&lt;/pre&gt;</p>
