id: dsq-747512175
date: 2007-02-07T04:59:13.0000000-08:00
name: Sergey Rybalkin
avatar: https://disqus.com/api/users/avatars/Sergey Rybalkin.jpg
message: <p>First of all thank you for the great article!<br>This is what I was looking for some time ago but unfortunately didn't find:-) So I had to implement my own SimpleWorkerRequest derived class. Regarding the issue with simulating the HttpRuntime - you can set all the required properties through reflection. I did it like this - <br>// get singleton property value<br>FieldInfo field = typeof(HttpRuntime).GetField("_theRuntime",<br>                BindingFlags.NonPublic | BindingFlags.Static);<br>            // set app path property value<br>            FieldInfo appPath = field.GetValue(null).GetType().GetField("_appDomainAppPath",<br>                BindingFlags.NonPublic | BindingFlags.Instance);<br>            appPath.SetValue(field.GetValue(null), "c:\\test\\ApplicationPath");<br>            // set codegen dir property value<br>            FieldInfo codegenPath = field.GetValue(null).GetType().GetField("_codegenDir",<br>                BindingFlags.NonPublic | BindingFlags.Instance);<br>            codegenPath.SetValue(field.GetValue(null), "c:\\test\\ApplicationPath");</p>
