id: dsq-747512176
date: 2007-02-13T06:31:04.0000000-08:00
name: Sideout
avatar: https://disqus.com/api/users/avatars/Sideout.jpg
message: "<p>I almost got it working using Sergey's technique, but I still cannot MapPath.  I get the exception:<br>System.Web.HttpException: The application relative virtual path '~/Data' cannot be made absolute, because the path to the application is not known.<br>at System.Web.VirtualPath.get_VirtualPathString()<br>at System.Web.HttpRequest.MapPath(VirtualPath virtualPath, VirtualPath baseVirtualDir, Boolean allowCrossAppMapping)<br>I tried to set _appDomainAppVPath using your technique but failed because it's a sealed VirtualPath class and not just a string<br>            FieldInfo field = typeof(HttpRuntime).GetField(\"_theRuntime\",<br>            BindingFlags.NonPublic | BindingFlags.Static);<br>            FieldInfo appVPath = field.GetValue(null).GetType().GetField(\"_appDomainAppVPath\",<br>            BindingFlags.NonPublic | BindingFlags.Instance);<br>            appVPath.SetValue(field.GetValue(null), vPath);<br>You got yours working somehow without that though?  My HttpContext.Current.Request.ApplicationPath is null probably because I don't have the AppVPath as well.  All the other Console.WriteLine's print out proper values though.</p>"
