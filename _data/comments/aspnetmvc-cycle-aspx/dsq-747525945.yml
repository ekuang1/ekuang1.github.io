id: dsq-747525945
date: 2008-08-07T04:57:25.0000000-07:00
name: Damien Guard
avatar: https://disqus.com/api/users/avatars/Damien Guard.jpg
message: <p>The real problem is that this extension method can not be used more than once in a page because it will not re-initialize and if used within another loop will upset the index of the others.<br>One option would be to provide a key on the method, e.g.<br>public static string Cycle(this HtmlHelper html, string key, params string[] strings) {<br>    var context = html.ViewContext.HttpContext;<br>    int index = Convert.ToInt32(context.Items[key]);<br>    context.Items[key] = index + 1;<br>    return strings[index % strings.Length];<br>}<br>Which still leaves you open to naming conflicts. An alternative is:<br>public static string Cycle(this HtmlHelper html, params string[] strings) {<br>    string key = string.Format("cycle_index_{0}", strings[0].GetHashCode() ^ strings[strings.Length-1].GetHashCode() ^ strings.Length.GetHashCode());<br>    var context = html.ViewContext.HttpContext;<br>    int index = Convert.ToInt32(context.Items[key]);<br>    context.Items[key] = index + 1;<br>    return strings[index % strings.Length];<br>}<br>Which still isn't perfect but at least makes up the key itself however will conflict if the first, last and number of items are the same. The only other alternative would involve going over each item which would be very expensive per-call.<br>[)amien<br></p>
