id: dsq-747526977
date: 2008-11-11T11:45:43.0000000-08:00
name: Speednet
avatar: https://disqus.com/api/users/avatars/Speednet.jpg
message: <p>Fun challenge!  I was not aware of all the screwy rules for HTML tag matching, so it's been a learning experience too.  So thanks!<br>Here's my Html class, written in VB.  It passed all the tests.  Here are the key points describing my code:<br>1. Uses a Regex that is compiled once at program startup, so that it will execute very quickly each time it's run, with any Regex compile hit happening during program load.<br>2. Uses atomic grouping in the HTML tag contents, which makes the Regex match happen very quickly and efficiently (no unnecessary backtracking).<br>3. Two uses of Regex conditionals -- something that people may not be used to seeing, but can be very useful.  The first use is for not grabbing a "&lt;" character that ends an HTML tag, but grabbing a "&gt;" if that's the character that ends the tag.  The second use matches a whitespace char after a comment only if a whitespace char was not matched before the comment.<br>4. In the Replace() call, both $1 and $2 will be empty for an HTML tag, but if it's a comment then one or the other (or neither) of $1 and $2 will be a single whitespace char.<br>5. It was not in the rules of the challenge, but this could also be modified fairly easily to treat HTML tags surrounded by whitespace in the same manner that comments are.  (Interwoven with text, with only one intermediate space remaining after a replacement.)<br>I hope the code comes out OK in your blog comments.  If it doesn't, please let me know the best way to do it.  (And consider adding preview! ;-)<br>-Todd ("Speednet")<br><br><code><br>Public Class Html<br>    Private Shared ReadOnly _Regex_HTML As New Regex("[=]\s*""[^""]*""|=\s*'[^']*'|[^&lt;&gt;])+(?(?=&lt;)|&gt;)|(\s)*]*&gt;(?(1)\s*|(\s)*)", RegexOptions.Compiled Or RegexOptions.IgnoreCase)<br>    Public Shared Function StripHtml(ByVal html As String) As String<br>        Return _Regex_HTML.Replace(html, "$1$2")<br>    End Function<br>End Class<br></code><br></p>
