id: dsq-747527000
date: 2008-11-13T03:01:23.0000000-08:00
name: Adam
avatar: https://disqus.com/api/users/avatars/Adam.jpg
message: "<p>@haacked: I found a port of strip_tags for c# and it passed 12/17 of the first tests you had displayed before adding the new ones.<br>I'm actually using the code in one of my sites and it seems to work fine but then again i'm only dealing with stripping the code from a wysiwyg editor.<br>Here it is for anyone interested.<br><code><br>public static string StripTags(this string str)<br>        {<br>            return str.StripTags(\"\");<br>        }<br>        public static string StripTags(this string str, string allowed_tags)<br>        {<br>            string pattern_for_all_tags = \"&lt;]+&gt;\";<br>            // pattern for allowed tags<br>            string allowed_patterns = \"\";<br>            if (allowed_tags != \"\")<br>            {<br>                // get allowed tags if any exists<br>                Regex r = new Regex(\"[\\\\/&lt;&gt; ]+\");<br>                allowed_tags = r.Replace(allowed_tags, \"\");<br>                string[] allowed_tags_array = allowed_tags.Split(',');<br>                foreach (string s in allowed_tags_array)<br>                {<br>                    if (s == \"\") continue;<br>                    // Definin patterns<br>                    string p_1 = \"&lt;\" + s + \" [^&gt;&lt;]*&gt;$\";<br>                    string p_2 = \"&lt;\" + s + \"&gt;\";<br>                    string p_3 = \"\";<br>                    if (allowed_patterns != \"\")<br>                        allowed_patterns += \"|\";<br>                    allowed_patterns += p_1 + \"|\" + p_2 + \"|\" + p_3;<br>                }<br>            }<br>            // Get all html tags included on string<br>            Regex strip_tags = new Regex(pattern_for_all_tags);<br>            MatchCollection all_tags_matched = strip_tags.Matches(str);<br>            if (allowed_patterns != \"\")<br>                foreach (Match m in all_tags_matched)<br>                {<br>                    Regex r_1 = new Regex(allowed_patterns);<br>                    Match m_1 = r_1.Match(m.Value);<br>                    if (!m_1.Success)<br>                    {<br>                        // if not allowed replace it<br>                        str = str.Replace(m.Value, \"\");<br>                    }<br>                }<br>            else<br>                // if not allow anyone replace all<br>                str = strip_tags.Replace(str, \"\");<br>            return str;<br>        }<br></code><br></p>"
