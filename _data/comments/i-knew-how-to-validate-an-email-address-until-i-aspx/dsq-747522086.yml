id: dsq-747522086
date: 2008-11-04T01:21:50.0000000-08:00
name: alexoss
avatar: https://disqus.com/api/users/avatars/alexoss.jpg
message: <p>This was a VERY valuable chunk of info for me!  Thank you!  I especially liked the C# code above, but I wrote my own version using RFC 2822 instead of 822, with the exceptions that I don't allow comments, folding (multiline) white space, white space generally (except within quoted-string and domain-literal), and obsolete syntax.  This is a singleton static method.<br><code><br>public static Regex GetInstance()<br>{<br>    lock (syncObject)<br>    {<br>        if (theRegex == null)<br>        {<br>            string ALPHA = "([\\x41-\\x5A]|[\\x61-\\x7A])";<br>            string DIGIT = "[\\x30-\\x39]";<br>            string DQUOTE = "\\x22";<br>            string WSP = "[\\x09\\x20]";<br>            string NO_WS_CTL = "[\\x01-\\x08\\x0B\\x0C\\x0E-\\x1F\\x7F]";<br>            string text = "[\\x01-\\x09\\x0B\\x0C\\x0E-\\x7F]";<br>            string atext = "(" + ALPHA + "|" + DIGIT + "|[\\!\\#\\$\\%\\&amp;\\'\\*\\+\\-\\/\\=\\?\\^_\\`\\{\\|\\}\\~])";<br>            string qtext = "(" + NO_WS_CTL + "|[\\x21\\x23-\\x5B\\x5D-\\x7E])";<br>            string dtext = "(" + NO_WS_CTL + "|[\\x21-\\x5A\\x5E-\\x7E])";<br>            string dot_atom_text = atext + "+(\\." + atext + "+)*";<br>            string dot_atom = dot_atom_text;<br>            string quoted_pair = "\\\\" + text;<br>            string qcontent = "(" + qtext + "|" + quoted_pair + ")";<br>            string dcontent = "(" + dtext + "|" + quoted_pair + ")";<br>            string quoted_string = DQUOTE + "(" + WSP + "?" + qcontent + ")*" + WSP + "?" + DQUOTE;<br>            string local_part = "(" + dot_atom + "|" + quoted_string + ")";<br>            string domain_literal = "\\[(" + WSP + "?" + dcontent + ")*" + WSP + "?" + "\\]";<br>            string domain = "(" + dot_atom + "|" + domain_literal + ")";<br>            string addr_spec = "^" + local_part + "\\@" + domain + "$";<br>            theRegex = new Regex(addr_spec);<br>        }<br>    }<br>    return theRegex;<br>}<br></code></p>
