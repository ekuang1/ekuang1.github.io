id: dsq-747524662
date: 2008-03-23T23:17:03.0000000-07:00
name: Oran
avatar: https://disqus.com/api/users/avatars/Oran.jpg
message: <p>Switching back and forth between record and replay makes tests harder to read, even more so with an implicit record/replay style like MoQ's.  Expectations are the mocking equivalent of Asserts, and I prefer to keep these all together for readability.  Put the Expects up front, the Asserts at the end, or both.  If there is the need to intersperse Expects or Asserts with the "middle" of the test, you're probably trying to cram two tests into one.  Remember, you should strive to have only one (logical) assert per test.<br>If the given example had used a property on the mock instead of setting a return value for a method, then the Rhino Mocks version could have been written in a similar style with the same number of lines of code as the MoQ version.<br>var mock = MockRepository.GenerateStub&lt;ISomethingUseful&gt;();<br>mock.Something = 123;<br>var myClass = new MyClass(mock);<br>Assert.AreEqual(...);<br>One of the reasons MoQ has fewer lines of code in the given example is because the MoQ mock isn't really a mock.  It's more of a stub.  This is a result of Daniel's fairly extreme position of only doing state verification, not behavior verification.  Even though Daniel has read Martin Fowler's essay "Mocks Aren't Stubs" [1] and uses it in his arguments for MoQ's unique philosophy, he hasn't demonstrated a clear understanding of the fact that, well, mocks aren't stubs.  The intro to Martin's essay talks about how he used to confuse mocks with stubs but later realized the differences, hence the essay.  Daniel has read this but comes away with Martin's pre-enlightenment perspective, not the perspective that Martin argues for in the essay.  That would be fine if he thought he understood Martin's arguments and consciously chose to disagree with them, but instead he believes he's saying the same thing that Martin is.  You can see some of his misunderstanding in the comments on Ayende's blog. [2]<br>[1] <a href="http://martinfowler.com/articles/mocksArentStubs.html" rel="nofollow noopener" title="http://martinfowler.com/articles/mocksArentStubs.html">http://martinfowler.com/art...</a><br>[2] <a href="http://www.ayende.com/Blog/archive/2007/12/19/Moq-Mocking-in-C-3.0.aspx" rel="nofollow noopener" title="http://www.ayende.com/Blog/archive/2007/12/19/Moq-Mocking-in-C-3.0.aspx">http://www.ayende.com/Blog/...</a></p>
