id: dsq-747537698
date: 2012-03-26T02:00:14.0000000-07:00
name: John Jelinek
avatar: https://disqus.com/api/users/avatars/John Jelinek.jpg
message: <p>Never mind. It's all fixed now.<br><code><br>Imports System<br>Imports System.Collections.Generic<br>Imports System.Linq<br>Imports System.Web<br>Imports System.Web.Http.Services<br>Public Class ServiceResolverAdapter<br>    Implements IDependencyResolver<br>    Private ReadOnly dependencyResolver As System.Web.Mvc.IDependencyResolver<br>    Public Sub New(dependencyResolver As System.Web.Mvc.IDependencyResolver)<br>        If dependencyResolver Is Nothing Then<br>            Throw New ArgumentNullException("dependencyResolver")<br>        End If<br>        Me.dependencyResolver = dependencyResolver<br>    End Sub<br>    Public Function GetService(serviceType As Type) As Object Implements IDependencyResolver.GetService<br>        Return dependencyResolver.GetService(serviceType)<br>    End Function<br>    Public Function GetServices(serviceType As Type) As IEnumerable(Of Object) Implements IDependencyResolver.GetServices<br>        Return dependencyResolver.GetServices(serviceType)<br>    End Function<br>End Class<br>Public Module ServiceResolverExtensions<br>    Sub New()<br>    End Sub<br>    &lt;System.Runtime.CompilerServices.Extension()&gt; _<br>    Public Function ToServiceResolver(dependencyResolver As System.Web.Mvc.IDependencyResolver) As IDependencyResolver<br>        Return New ServiceResolverAdapter(dependencyResolver)<br>    End Function<br>End Module<br></code></p>
