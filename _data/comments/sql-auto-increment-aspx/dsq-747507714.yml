id: dsq-747507714
date: 2011-10-20T06:57:02.0000000-07:00
name: Scott Ward
avatar: https://disqus.com/api/users/avatars/Scott Ward.jpg
message: <p>Great tip.<br>For me it did add the counter column in an unordered way, I have a date field in my table and when viewing the table the dates are ordered (without sorting) but the counter is all over the place compared to the date order.<br>Here is my solution which allows some extra room for using an order by to add the counter in an ordered manner and also would allow limiting which records to get the counter, if needed.<br>But you need a unique Date or other column for this to work<br>(one option might be to use your SQL to add the counter ID column, then use my code to add a new column in the order you need it and only to the records you need it for, then remove the first counter column)<br>--Add counter to all rows <br>Update [Table] SET ID = tblTemp.ID <br>FROM [Table] tblOriginal,<br>(Select DateCol, Row_Number() OVER (ORDER BY DateCol) AS ID FROM [Table]) tblTemp<br>WHERE tblOriginal.DateCol = tblTemp.DateCol<br>--Add counter to Selected rows only<br>Update [Table] SET ID = tblTemp.ID <br>FROM [Table] tblOriginal,<br>(Select DateCol, Row_Number() OVER (ORDER BY DateCol) AS ID FROM [Table]  WHERE DateCol &gt; '2010/01/01') tblTemp<br>WHERE tblOriginal.DateCol = tblTemp.DateCol<br></p>
